<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <script type="text/javascript" language="gaia">
      {按钮点击}
      function onclick()
      {
        var(sender, '', pName, '');
        getsender(sender);
        getproperty(pName, sender, 'name');
        if(str.equals(pName, 'btnCancel')){ closewindow();}
        if(str.equals(pName, 'btnOK'))
        { 
          if(savenewplan())
          { 
            closewindow();
          }
        }
      }

      {保存新的计划}
      function savenewplan()
      {
        var(sender, '', name, '' , stime, '', cmd, '', member, '');
        getsender(sender);
        getproperty(name, 'txtName', 'text');
		getproperty(stime, 'dtpNextTime', 'text');
        getproperty(cmd, 'txtScript', 'text');
		getproperty(member, 'txtMember', 'text');
        if(str.length(name) = 0)
        {
          alert('请填写名称!','提示');
          return(0);
        }
		if(str.length(stime) = 0)
		{
			alert('请填写时间!','提示');
			return(0);
		}
		if(str.length(member) = 0)
		{
			alert('请填写相关人员!','提示');
			return(0);
		}
		if(str.length(cmd) = 0)
		{
			alert('请填写结果!','提示');
			return(0);
		}
        plan.create(name, stime, member, cmd);
        return(1);
      }
    </script>
  </head>
  <body>
    <div type="usercontrol" cid="windowex" name="windowCreatePlan" size="374,430" location="3,3" text="创建任务">
      <label name="Label1" location="15,38" size="46,20" text="名称：" />
      <label name="Label2" location="15,110" size="73,17" text="相关人员：" />
      <label name="Label3" location="15,149" size="73,17" text="最终结果：" />
      <input type="text" name="txtName" location="107,36" size="240,21" text="新的任务" />
      <input type="text" name="txtScript" location="15,176" size="345,186" text="进行中..." multiline="true" tabstop="false" wordwrap="true" />
      <input type="usercontrol" cid="ribbonbutton" name="btnOK" location="147,386" size="79,28" Text="确定" onclick="onclick();" />
      <input type="usercontrol" cid="ribbonbutton" name="btnCancel" location="245,386" size="79,28" Text="关闭" onclick="onclick();" />
      <label name="Label" text="结束时间：" location="15,74" size="73,17" />
      <input type="datetime" name="dtpNextTime" location="107,70" size="240,20" customformat="yyyy-MM-dd HH:mm:ss" />
      <input type="text" name="txtMember" location="107,106" size="240,20" />
    </div>
  </body>
</html>