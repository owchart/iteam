<?xml version="1.0" encoding="utf-8"?>
<html>
  <head>
    <script type="text/javascript" language="gaia">
      {鼠标点击事件}
      function onclick()
      {
          var(sender, '');
          getsender(sender);
          if(str.equals(sender, 'btnCreate')) {showwindow('CreatePlanWindow', 'windowCreatePlan');}
          else if(str.equals(sender, 'btnModify')) {showwindow('ModifyPlanWindow', 'windowModifyPlan');}
          else if(str.equals(sender, 'btnDelete')) {plan.delete();}
          else if(str.equals(sender, 'btnStart')) {plan.start();}
      }

      {窗体加载事件}
      function onload()
      {
        starttimer('divMain', 10000, 1000);
      }

      {秒表事件}
      function ontimer()
      {
        plan.check();
      }

      {行选中事件}
      function selectedrowchanged()
      {
        plan.select();
      }
    </script>
  </head>
  <body>
    <div type="splitlayout" name="divMain" candragsplitter="true" layoutstyle="bottomtotop" dock="fill" size="400,400" splitterposition="0,360,400,360" onload="onload();" ontimer="ontimer();">
      <!--右边图层-->
      <div name="divRight" type="layout" style="lefttoright" showhscrollbar="true">
        <input type="usercontrol" cid="ribbonbutton" name="btnCreate" forecolor="80,255,80" font="微软雅黑,14,bold" text="创建任务" size="175,38" onclick="onclick();" />
        <input type="usercontrol" cid="ribbonbutton" name="btnModify" forecolor="255,80,255" font="微软雅黑,14,bold" text="修改任务" size="175,38" onclick="onclick();" />
        <input type="usercontrol" cid="ribbonbutton" name="btnDelete" forecolor="200,200,200" font="微软雅黑,14,bold" text="删除任务" size="175,38" onclick="onclick();" />
        <input type="usercontrol" cid="ribbonbutton" name="btnStart" font="微软雅黑,14,bold" text="启动任务" size="175,38" onclick="onclick();" />
        <input type="usercontrol" cid="ribbonbutton" name="btnExportTxt" forecolor="80,255,255" font="微软雅黑,14,bold" text="导出到Txt" size="175,38" />
        <input type="usercontrol" cid="ribbonbutton" name="btnExportExcel" forecolor="80,255,255" font="微软雅黑,14,bold" text="导出到Excel" size="175,38" />
      </div>
      <!--计划表格-->
      <table name="gridPlan" autoellipsis="true" onselectedrowchanged="selectedrowchanged();" headerheight="30">
        <tr>
          <th name="colP1" text="ID" visible="false" />
          <th name="colP2" text="任务名称" width="200" />
          <th name="colP10" text="责任人" width="200" />
          <th name="colP4" cellalign="center" text="状态" width="60" visible="false" />
          <th name="colP5" text="到期时间" width="200" />
          <th name="colP6" text="上次运行时间" width="150" visible="false" />
          <th name="colP7" text="上次运行结果" width="80" visible="false" />
          <th name="colP8" cellalign="center" text="频率(秒)" width="80" visible="false" />
          <th name="colP9" text="开始时间" width="200" />
          <th name="colP3" text="结果" width="300" />
        </tr>
      </table>
    </div>
  </body>
</html>